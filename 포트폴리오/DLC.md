## 🐱 DLC(Data Life Cycle)로 인한 5년 이전 데이터 삭제 프로시저 개발

- 방송통신 법으로 인하여서 현재로부터 5년 이전 데이터 삭제 프로시저 개발 <br>
- 담당자에게 매일 DLC진척율을 이메일로 받을 수 있도록 프로그램 개발 및 템플릿 작성 <br>
- 현재 삭제 진행중인 년/월을 기준으로 12개월 전부터 2개월 후의 데이터까지 노출 <br>
- 서버 로그를 통한 모니터링 진행

<br>

## 🧑‍🤝‍🧑 제작 기간 & 참여 인원

  	-  제작 기간 : 2024.04.01 ~ 진행중 
  	-  참여 인원 : 2명
<br>

## ⚙️ 사용 기술 스택

<br>

| ⚙️ 기술 스택 | 👇🏻 사용 목적 |
|--|--|
| **`ORACLE`** | 프로시저 개발 |
| **`REST API`** | 데이터 삭제 진척율 이메일 발송 |
| **`linux`** | 프로시저 스케줄링 및 이메일 발송 스케줄링 |
| **`MyBatis`** | ORM 구현 |

<br>

## 핵심 기능
	이 서비스의 핵심 기능은 5년 전 데이터 삭제 배치입니다. 
	
	방송통신 법으로 인하여서 5년 전 데이터를 삭제를 해야하고 총 30개의 테이블을 대상으로 하여 5년 전 데이터를 삭제합니다.
	
	데이터가 어느 기간의 몇 개의 데이터가 삭제가 됐는지 진척율을 REST API를 통해 템플릿을 짜고 전송해주었습니다.

	임시상품코드, 주문번호, 배송식별번호를 기준으로 5년 전의 데이터들을 여러 검증을 한 후에 MNT_COL_DT라는 테이블에 INSERT를 하여 수집을 하였습니다.
	
	후에 MNT_COL_DT에 있는 수집한 데이터들을 MOD함수를 통하여서 개수를 분산화하여 삭제를 진행해주는 커서를 작성하였습니다.
	
	테이블 데이터 삭제를 하기 전에 SALE_TEST라는 계정에 삭제 대상 테이블을 똑같이 생성하여 백업을 시킨 후에 실제로 쓰이고 있는 테이블의 데이터를 삭제했습니다.
	
	다음 사진은 DLC의 진척율을 매일 담당자에게 이메일을 보내는 REST API 개발한 이메일 템플릿입니다.

<div align="center" markdown="1">
	<img src="https://github.com/jsjang96/images/blob/d04859a68b125e8748551b29bc58c77119195aae/DLCProgressEmail.png"/>
</div>

	위의 사진은 년도별로 임시상품코드, 주문번호, 배송식별번호를 기준으로 데이터를 삭제한 진척율을 저를 포함한 담당자들에게 매일 이메일을 보내주는
 
 	템플릿입니다.

<br>

## 트러블 슈팅

### 1. I/O 오류
	커넥션 수도 늘려보고 한번의 트랜잭션에서 처리하는 데이터를 줄여봤지만 여전히 I/O오류가 났습니다.
 
	원인은 DB스펙의 문제였고 DB스펙을 향상시키는데는 현실적으로 어려움이 있기 때문에 MOD함수를 써서 sequnce를 6으로 나눠서 나머지가 0,1,2,3,4,5로 나누어서 
 
	프로시저를 각각 개발을 하였고 시간이 최대한 겹치지 않게 스케줄링을 하여 실행 시켰습니다. 
 
	추후 방향은 프로시저 개발한 것을 다른 DB로 이관하는 방향으로 논의가 됐습니다.

## 느낀점

### 1. 자신감
	프로시저에 대해서 공부하고 처음으로 개발을 한 건입니다. 처음에는 데이터를 어떻게 수집을 하고 어떻게 처리르 해야하는지 구상하는 것에 있어서 어려움이 있었습니다.
	
	주문번호, 배송식별번호, 임시상품코드를 쓰고 있는 테이블들의 데이터들을 한 테이블에 수집을 하여서 이 수집한 데이터를 가지고 삭제를 하는 구조를 
	
	생각하고 보고를 드렸을 때 이대로 추진하자는 피드백을 받았고 거기에 대한 쾌감과 자신감을 얻었습니다. 쿼리를 짜는 것에 있어서 계획을 하고 짰었고
	
	MOD함수를 통하여서 I/O 오류에 대해 트러블 슈팅을 할 수 있었을 때 계획하고 생각하고 했을 때 잘 할 수 있는 자신을 보며 자신감을 얻었습니다.

### 2. 의사소통
	프로시저를 개발하는 것을 담당자에게 설명을 하고 이해시키는 것에 있어서 다소 어려움이 있었습니다. 내가 알고 있는 것들을 사람들에게 알려주고 소통하는 것이 쉽지 않았습니다.
	
	이제까지 살면서 의사소통에 대한 문제가 없어서 회사에 와서도 문제가 없을거란 생각을 했습니다. 하지만 상대방이 모르는 것을 내가 알려줄 때 어려움을 겪었습니다.
	
	이러한 의사소통에 대한 어려움을 겪고 다음에 알려줄 때 이것을 어떻게 이해를 시켜줄지 연구를 하고 필터링을 하여서 알려주었을 때 의사소통이 되었습니다.
